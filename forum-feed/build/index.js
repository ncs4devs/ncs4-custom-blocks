!function(){"use strict";var e={};function t(){return t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},t.apply(this,arguments)}e.n=function(t){var l=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(l,{a:l}),l},e.d=function(t,l){for(var a in l)e.o(l,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:l[a]})},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var l=window.wp.element,a=window.wp.blocks,n=window.wp.blockEditor;function r(e,t){let l={};for(let a in t)if(("string"==typeof t[a]||"image"===e[a].type)&&e[a]&&"object"==typeof e[a]&&e[a].type)switch(e[a].type){case"string":l[a]=t[a];break;case"boolean":case"bool":case"int":case"integer":case"number":case"json":l[a]=JSON.parse(t[a]);break;case"image":l[a]=t[a][0]||t[a];break;case"null":null!==t[a]&&""!==t[a]&&"null"!==t[a]&&console.warn("Attribute '"+a+"': expected null, got '"+t[a]+"'"),l[a]=null;break;default:console.warn("Attribute '"+a+"': Unknown type '"+e[a].type+"'")}else l[a]=t[a];return l}var o=window.wp.components;function s(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var i=window.React,p=e.n(i);class c extends p().Component{getChoices(e){let t=[];return e.forEach(((e,l)=>{t[l]={attribute:e.attribute,value:NaN==e.value||null==e.value?e.default:e.value}})),t}getChoice(e,t){for(let l of t)if(l.attribute===e)return l}render(){let e=isNaN(this.props.maxRadioOptions)?5:this.props.maxRadioOptions,t=this.props.options,a=this.props.onChange,n=this.getChoices(t),r=[...Array(t.length).keys()].map((r=>(0,l.createElement)(u,{key:r,maxRadioOptions:e,label:t[r].label,help:t[r].help,choices:t[r].choices,multiple:t[r].multiple,invertValue:t[r].invertValue,min:t[r].min,max:t[r].max,step:t[r].step,markStep:t[r].markStep,markRender:t[r].markRender,tooltipRender:t[r].tooltipRender,value:this.getChoice(t[r].attribute,n).value,disabled:t[r].disabled,callback:e=>{"function"==typeof t[r].onChange&&(e=t[r].onChange(e)),a({[t[r].attribute]:e})}})));return(0,l.createElement)(l.Fragment,null,r)}}class u extends p().Component{render(){let e=this.props.maxRadioOptions,t=this.props.value,a=this.props.label,n=this.props.help,r=this.props.choices,s=this.props.min,i=this.props.max,p=this.props.step,c=this.props.markStep,u=this.props.markRender,b=this.props.tooltipRender,g=this.props.multiple,v=this.props.invertValue||!1,f=this.props.disabled,x=this.props.callback;return(0,l.createElement)(l.Fragment,null,Array.isArray(t)?(0,l.createElement)(m,this.props):r?g?(0,l.createElement)(h,{label:a,help:n,options:r,value:t,callback:x,disabled:f}):r.length<=e?(0,l.createElement)(o.RadioControl,{label:a,help:n,selected:t,onChange:x,options:r,disabled:f}):(0,l.createElement)(o.SelectControl,{label:a,help:n,value:t,onChange:x,options:r,disabled:f}):isNaN(s)||isNaN(i)?(0,l.createElement)(o.ToggleControl,{label:a,help:n,checked:v!=Boolean(t),onChange:e=>x(v!=e),disabled:f}):(0,l.createElement)(d,{label:a,help:n,value:t,min:s,max:i,step:p,markStep:c,markRender:u,tooltipRender:b,disabled:f,callback:x}))}}class m extends p().Component{getProps(e,t){var l={...e};for(let[e,a]of Object.entries(l))Array.isArray(a)&&(l[e]=a[t]);return l}render(){let e=this.props.value,a=this.props.callback,n=[...Array(e.length).keys()].map((n=>(0,l.createElement)(u,t({},this.getProps(this.props,n),{key:n,callback:t=>{let l=[...e];l[n]=t,a(l)}}))));return(0,l.createElement)(l.Fragment,null,n)}}class h extends p().Component{constructor(e){super(e),this.id="ncs4-components-checkboxgroup-"+String(document.getElementsByClassName("ncs4-components-checkboxgroup").length)}render(){let e=this.props.label,t=this.props.help,a=this.props.value,n=this.props.options,r=this.props.disabled,s=this.props.callback,i=[...Array(n.length).keys()].map((e=>(0,l.createElement)(o.CheckboxControl,{key:e,label:n[e].label,checked:a.includes(n[e].value),disabled:r,name:this.id,onChange:t=>{var l=[...a];if(t)l.push(n[e].value);else{let t=l.indexOf(n[e].value);t>-1&&l.splice(t,1)}s(l)}})));return(0,l.createElement)("div",{className:"ncs4-components-checkboxgroup"},(0,l.createElement)("label",{className:"components-base-control__label css-pezhm9-StyledLabel e1puf3u2",for:this.id},e),(0,l.createElement)("p",{className:"components-base-control__help css-1gbp77-StyledHelp e1puf3u3"},t),i)}}class d extends p().Component{createMarks(e,t,l,a){var n=Array(Math.floor((t-e)/l)+1);for(let t=0;t<n.length;t++)n[t]={value:e,label:a(e)},e+=l;return n}render(){let e=this.props.label,t=this.props.help,a=this.props.value,n=this.props.min,r=this.props.max,s=this.props.step||1,i=this.props.markStep||s,p=this.props.markRender||(e=>String(e)),c=this.props.disabled,u=this.props.tooltipRender||p,m=this.props.callback;return(0,l.createElement)(o.RangeControl,{label:e,help:t,value:a,min:n,max:r,step:s,marks:this.createMarks(n,r,i,p),renderTooltipContent:u,disabled:c,onChange:m})}}class b extends p().Component{clamp(e,t,l){return Math.min(Math.max(e,t),l)}getUnitSettings(e){for(let t of e.units)if(t.value===e.value)return t;return e.units[0]}render(){let e=this.props.label,a=this.props.help,n=this.props.disabled,r=this.props.toggleSelector,s=this.props.unitSelector,i=this.props.slider,p=r&&r.attribute,c=null==r||0===Object.keys(r).length||r.value||r.default,m=s.value||s.default,h=isNaN(i.value)?i.default:i.value,b=e=>this.props.onChange(Object.assign({[p]:c,unit:m,value:h,asString:String(h)+m},e));null!=p&&r&&void 0===r.value&&b({[p]:c}),void 0===s.value&&b({unit:m}),isNaN(i.value)&&(b({value:h}),b({asString:String(h)+m}));let g=n||!c,v=this.getUnitSettings(s);return(0,l.createElement)(l.Fragment,null,e&&(0,l.createElement)("p",{className:"components-base-control__label css-pezhm9-StyledLabel e1puf3u2"},e),(0,l.createElement)(o.PanelRow,null,p&&(0,l.createElement)(u,t({},r,{value:c,callback:e=>b({[p]:e}),disabled:n})),(0,l.createElement)(u,t({},s,{multiple:!1,choices:s.units,disabled:g,callback:e=>{let t=this.getUnitSettings({...s,value:e}),l=this.clamp(h,t.min,t.max);b({unit:e,value:l,asString:String(l)+e})}}))),(0,l.createElement)(d,t({},i,{value:h,min:v.min,max:v.max,step:v.step,markStep:v.markStep||v.step,tooltipRender:e=>String(e)+(v.label||v.value),disabled:g,callback:e=>{let t=this.clamp(e,v.min,v.max);b({value:t,asString:String(t)+m})}})),a&&(0,l.createElement)("p",{className:"components-base-control__help css-1gbp77-StyledHelp e1puf3u3"},a))}}class g extends p().Component{validateNumber(e){return!Boolean(e)||g.reg.test(e)}render(){let e=this.validateNumber(this.props.value);return(0,l.createElement)(o.TextControl,{value:this.props.value,onChange:e=>{this.props.onChange(e)},label:"Phone",help:e?null:"Unrecognized phone number format (perhaps you've made a typo?)"})}}s(g,"reg",/^(\+?[0-9]{1,4})?[ \-.]*[0-9]{3}[ \-.]*[0-9]{3}[ \-.]*[0-9]{4}$/);class v extends p().Component{validateEmail(e){return!Boolean(e)||v.reg.test(e)}render(){let e=this.validateEmail(this.props.value);return(0,l.createElement)(o.TextControl,{value:this.props.value,onChange:e=>{this.props.onChange(e),this.validateEmail(e)&&this.props.onChangeComplete(e)},label:"Email",help:e?null:"Invalid email address"})}}s(v,"reg",/^(?:[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-zA-Z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/);var f=window.wp.data,x=e=>{let t=(0,f.select)("core/block-editor").getSettings();return(0,l.createElement)(l.Fragment,null,(0,l.createElement)("p",null,e.label),(0,l.createElement)(o.ColorPalette,{colors:t.colors,disableCustomColors:t.disableCustomColors,value:e.value,onChange:l=>{let a=function(e,t){return t.filter((t=>t.color===e))[0]||null}(l,t.colors);e.onChange({color:l,slug:a?a.slug:null})}}))};function y(e){return(0,l.createElement)(l.Fragment,null,e.useInlineSvg?(0,l.createElement)("div",{dangerouslySetInnerHTML:{__html:e.img.data}}):(0,l.createElement)("embed",{type:e.img.mime,src:e.img.url}))}const k=e=>({marginLeft:"left"==e.align?0:"auto",marginRight:"right"==e.align?0:"auto"});function E(e){e.useInlineSvg=null==e.useInlineSvg||e.useInlineSvg;const t=!e.img||"object"==typeof e.img&&0==Object.keys(e.img).length;return(0,l.createElement)(n.MediaUploadCheck,null,(0,l.createElement)(n.MediaUpload,{onSelect:t=>{let l={url:t.url,mime:t.mime,inline:!("image/svg+xml"!==t.mime||!e.useInlineSvg)||void 0,width:t.width,height:t.height};e.onChange(l)},value:e.img?e.img.id:null,allowedTypes:["image"],render:a=>{let{open:n}=a;return(0,l.createElement)(o.Button,{className:t?"editor-post-featured-image__toggle":"editor-post-featured-image__preview",style:{marginBottom:"24px"},onClick:n},t?"Choose an image":"image/svg+xml"===e.img.mime&&e.img.data?(0,l.createElement)(y,{img:e.img,useInlineSvg:e.useInlineSvg,style:k(e)}):(0,l.createElement)("img",{src:e.img.url,style:k(e)}))}}))}function C(e){let a=e.save;return a||console.error("Prop 'save' is null or undefined. React component expected"),(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"}},(0,l.createElement)(a,t({},e,{style:{...e.style,flex:"0 1 840px"},attributes:e.state,blockProps:e.blockProps,backend:!0}))),(0,l.createElement)(n.InspectorControls,null,e.controlPanels.map(((a,n)=>(0,l.createElement)(w,t({},a,{state:e.state,setAttribute:e.setAttribute,key:n}))))))}function w(e){let a=null==e.initialOpen||e.initialOpen,n=e.setAttribute,r=e.state;return(0,l.createElement)(o.PanelBody,{title:e.label,initialOpen:a},e.controls.map(((e,a)=>{if(e.disabled)return null;switch(e.type){case"text":return(0,l.createElement)(o.TextControl,t({},e,{key:a,value:r[e.attribute],onChange:n(e.attribute)}));case"unit":return(0,l.createElement)(b,t({},e,{key:a,toggleSelector:e.useToggle?{attribute:"enabled",label:e.toggleLabel,help:e.toggleHelp,value:r[e.attribute].enabled}:{},unitSelector:{label:e.selectorLabel,value:r[e.attribute].unit,units:e.selectorChoices},slider:{label:e.sliderLabel,help:e.sliderHelp,value:r[e.attribute].value},onChange:n(e.attribute)}));case"color":return(0,l.createElement)(x,t({},e,{key:a,value:r[e.attribute].color,onChange:n(e.attribute)}));case"image":return(0,l.createElement)(E,t({},e,{onChange:t=>function(e,t){arguments.length>2&&void 0!==arguments[2]&&!arguments[2]||"image/svg+xml"!==e.mime?t(e):fetch(e.url).then((e=>e.text())).then((l=>{e.data=l,t(e)}))}(t,n(e.attribute)),img:r[e.attribute]}));case"choice":return(0,l.createElement)(c,{options:[{...e,value:r[e.attribute]}],maxRadioOptions:e.maxRadioOptions,key:a,type:e.type,onChange:t=>n(e.attribute)(t[e.attribute])});case"phone":return(0,l.createElement)(g,t({},e,{key:a,value:r[e.attribute],onChange:n(e.attribute)}));case"email":return(0,l.createElement)(v,t({},e,{key:a,value:r[e.attribute],onChange:n(e.attribute)}));default:console.error("ControlPanel: Invalid control type '"+e.type+"'")}})))}const S=e=>t=>{e(((e,l)=>Object.assign({},e,t)))};function N(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,l]=(0,i.useState)(e);return[t,S(l)]}var O=window.wp.editor;function R(e){let[a,n,r]=function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},[n,r]=N(l),o=l=>n=>{r({[l]:n}),t({[l]:"function"==typeof a[l]&&a[l].length<=2?a[l](n,e):n})};return[n,o,e=>{for(let t in e)o(t)(e[t])}]}(e.attributes,e.setAttributes,{...e.attributes},{ref:e=>Number(e)<0?void 0:e}),[o,s]=(0,i.useState)(null);return(0,i.useEffect)((()=>{!async function(e){fetch("/wp-json/wp/v2/forum").then((e=>e.json())).then((t=>{t.data&&t.data.status>399&&console.error("AJAX forum fetch error:",t),e(function(e){let t=[{value:"-1",label:"---Please select a Forum---"}];if(e&&null!=e&&(e.length>0||Object.keys(e).length>0))for(let l of e)t.push({value:String(l.id),label:l.title.rendered});return t}(t))}))}(s)}),[]),(0,l.createElement)(C,t({},e,{save:P,state:a,setAttribute:n,controlPanels:[{label:"General",controls:[{type:"choice",label:"Forum",help:"Which forum to display posts from",attribute:"ref",maxRadioOptions:0,disabled:!o||0==o.length,choices:o},{type:"choice",label:"Max topics",help:"How many topics may be displayed",attribute:"maxPosts",min:1,max:10,step:1},{type:"choice",label:"Show new topic link",help:a.showNewTopicLink?"A link to create a new topic is shown":"No link is shown",attribute:"showNewTopicLink"}]}]}))}function P(e){let a=e.blockProps,n=e.attributes;return(0,l.createElement)("div",t({},a,{"data-forum":n.ref,"data-max-posts":n.maxPosts,"data-show-link":n.showNewTopicLink,className:["ncs4-forum-feed",a.className].join(" ")}),(0,l.createElement)(O.ServerSideRender,{block:e.name,attributes:e.attributes}))}const A={ref:{type:"int"},maxPosts:{type:"int",default:5},showNewTopicLink:{type:"bool",default:!0}};(0,a.registerBlockType)("ncs4-custom-blocks/forum-feed",{apiVersion:2,title:"Forum Feed",icon:"rss",category:"widget",attributes:A,edit:e=>(0,l.createElement)(R,t({},e,{attributes:r(A,e.attributes),blockProps:(0,n.useBlockProps)()}))})}();